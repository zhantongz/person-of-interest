\documentclass[letterpaper, 12pt]{report}
% This is the project summary of the final project for Computer Science 20 at
% Western Canada High School by Zhantong Zhang in the December of 2013.

\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage[final]{pdfpages}
\usepackage{listings}
\usepackage{color}
\usepackage{ifthen}
\usepackage{makeidx}
\usepackage[hidelinks,bookmarks,pdfpagelabels,breaklinks=true]{hyperref}
\def\UrlBreaks{\do\A\do\B\do\C\do\D\do\E\do\F\do\G\do\H\do\I\do\J
\do\K\do\L\do\M\do\N\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V
\do\W\do\X\do\Y\do\Z\do\[\do\\\do\]\do\^\do\_\do\`\do\a\do\b
\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j\do\k\do\l\do\m\do\n
\do\o\do\p\do\q\do\r\do\s\do\t\do\u\do\v\do\w\do\x\do\y\do\z
\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]\do\)\do\,
\do\?\do\'\do\+\do\=\do-\do\#}

\newcommand{\entityintro}[3]{%
  \hbox to \hsize{%
    \vbox{%
      \hbox to .2in{}%
    }%
    {\bf  #1}%
    \dotfill\pageref{#2}%
  }
  \makebox[\hsize]{%
    \parbox{.4in}{}%
    \parbox[l]{5in}{%
      \vspace{1mm}%
      #3%
      \vspace{1mm}%
    }%
  }%
}
\newcommand{\refdefined}[1]{
\expandafter\ifx\csname r@#1\endcsname\relax
\relax\else
{$($in \ref{#1}, page \pageref{#1}$)$}\fi}
\chardef\textbackslash=`\\

% flowchart elements
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows}
\tikzstyle{startstop} = [rectangle, rounded corners, minimum width=3cm, minimum
height=1cm,text centered, draw=black, fill=red!30]
\tikzstyle{io} = [trapezium,
trapezium left angle=70, trapezium right angle=110, minimum width=2.5cm, minimum
height=1cm, text centered, draw=black, fill=blue!30, text width=3cm]
\tikzstyle{process} =
[rectangle, minimum width=3cm, minimum height=1cm, text centered, draw=black,
fill=orange!30, text width=3cm]
\tikzstyle{decision} = [diamond, minimum width=3cm, minimum
height=1cm, text centered, draw=black, fill=green!30, text width=3cm]
\tikzstyle{arrow} =
[thick,->,>=stealth]

\usepackage{graphicx}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{titlesec}
\titleformat{\chapter}[frame]{\normalfont\huge\bfseries}{\chaptertitlename\
\thechapter}{20pt}{\huge}
% \titleformat{\section}{\normalfont\bfseries}{}{0pt}{\Large}
% \titleformat{\subsection}{\normalfont\bfseries}{}{0pt}{\large}

\begin{document}
\input{./tex/title.tex}

\chapter*{LICENSE}
\thispagestyle{empty}
\input{./tex/license.tex}
\addtocounter{page}{-1}
\setcounter{tocdepth}{2}

\tableofcontents

% proposal copy
\part{Copy of the Project Proposal}
The original signed proposal is attached in the binder; the following is a
\emph{copy} of the proposal:

\includegraphics[width=0.9\linewidth]{./img/prop-1}

\includegraphics[width=0.9\linewidth]{./img/prop-2}

\includegraphics[width=0.9\linewidth]{./img/prop-3}

\includegraphics[width=0.9\linewidth]{./img/prop-4}

% design
\part{Preliminary Design}
\chapter{Diagrams}
% flowchart
\section{Program Process}
\subsection{Overall Process}
\begin{tikzpicture}[node distance=2.5cm]

\node(start)[startstop]{Start};
\node(init)[process, right of=start, xshift=3cm]{Initialization};
\node(prompt)[io, below of=init]{Prompt};
\node(in1)[io, below of=prompt]{User input};
\node(procInput)[process, below of=in1]{Process input};
\node(update)[process, below of=procInput]{Update properties};
\node(ifQuit)[decision, below of=update, aspect=2.5]{The game ends?};
\node(stop)[startstop, left of=ifQuit, xshift=-3cm]{Stop};

\draw[arrow](start) -- (init);
\draw[arrow](init) -- (prompt);
\draw[arrow](prompt) -- (in1);
\draw[arrow](in1) -- (procInput);
\draw[arrow](procInput) -- (update);
\draw[arrow](update) -- (ifQuit);
\draw[arrow](ifQuit) node[anchor=south, xshift=4cm]{no} --
([xshift=3cm]ifQuit.east) |- (prompt);
\draw[arrow](ifQuit) node[anchor=south, xshift=-3cm, yshift=-0.1cm]{yes} --
(stop);

\end{tikzpicture}

\subsection{Initialization}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(ifLoad)[decision, below of=begin, aspect=2.5, text width=3cm]{\tiny{The
player wants to load a saved game?}};

\node(loadPath)[io, below of=ifLoad, text width=3cm]{Prompt user to enter the
path and user input};
\node(load)[process, below of=loadPath]{Load the file and get
the saved player};

\node(new)[io, right of=ifLoad, xshift=4cm]{Prompt user
to enter name and choose a base and user input};
\node(newPlayer)[process, below of=new]{Create new player
with the specified name and base};

\node(player)[process, below of=newPlayer]{Use the player as the
game player};
\node(newMst)[process, right of=player, xshift=2.5cm]{Generate a new
mission};
\node(mst)[process, below of=newMst]{Use the new mission as
the current mission};
\node(end)[startstop, left of=mst, xshift=-2.5cm]{End};

\draw[arrow](begin) --(ifLoad);
\draw[arrow](ifLoad) -- node[anchor=west]{yes}(loadPath);
\draw[arrow](ifLoad) -- node[anchor=south]{no}(new);

\draw[arrow](loadPath) -- (load);

\draw[arrow](new) --  (newPlayer);

\draw[arrow](load) -- (player);
\draw[arrow](newPlayer) -- (player);
\draw[arrow](player) -- (newMst);
\draw[arrow](newMst) -- (mst);
\draw[arrow](mst) -- (end);

\end{tikzpicture}

\subsection{Prompt}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(ifComp)[decision, below of=begin, aspect=2.5]{\tiny{The current mission
completed?}};

\node(generate)[process, below of=ifComp]{Generate a new
mission};
\node(use)[process, below of=generate]{Use the new mission as
the current mission};

\node(ifNew)[decision, right of=ifComp, text width=2.5cm,
xshift=3.5cm, aspect=3.5]{\tiny{The mission is new?}};
\node(nextProb)[process, right of=ifNew, xshift=2.5cm]{Use the next problem as
the current problem};
\node(1stProb)[process, below of=ifNew]{Use the first problem as the current
problem};
\node(disp)[io, below of=nextProb]{Display the problem};
\node(end)[startstop, below of=disp]{End};

\draw[arrow](begin) -- (ifComp);
\draw[arrow](ifComp) -- node[anchor=west]{yes}(generate);
\draw[arrow](generate) -- (use);
\draw[arrow](use) -- ([xshift=-1.5cm]use.west) |- (ifComp);

\draw[arrow](ifComp) -- node[anchor=south]{no}(ifNew);
\draw[arrow](ifNew) -- node[anchor=south]{no}(nextProb);
\draw[arrow](ifNew) -- node[anchor=west]{yes}(1stProb);
\draw[arrow](1stProb) -- (disp);
\draw[arrow](nextProb) -- (disp);
\draw[arrow](disp) -- (end);

\end{tikzpicture}

\subsection{User Input}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(in)[io, below of=begin, yshift=0.5cm]{User input};
\node(trap)[decision, below of=in, aspect=2.5]{The input is eligible?};
\node(end)[startstop, below of=trap]{End};

\draw[arrow](begin) -- (in);
\draw[arrow](in) -- (trap);
\draw[arrow](trap) node[anchor=south, xshift=3.5cm]{no} --
([xshift=2cm]trap.east) |- (in);
\draw[arrow](trap) -- node[anchor=west]{yes}(end);

\end{tikzpicture}
\subsubsection{Determine if the input is eligible for commands}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(in)[process, below of=begin, yshift=0.5cm]{Get user input};
\node(trap)[decision, below of=in, aspect=2.5]{The input is in the list of
commands?};
\node(error)[io, right of=trap, xshift=5cm]{Output Not Command error};
\node(good)[startstop, below of=trap, yshift=-1cm]{Eligible};
\node(bad)[startstop, right of=good, xshift=5cm]{Ineligible};

\draw[arrow](begin) -- (in);
\draw[arrow](in) -- (trap);
\draw[arrow](trap) -- node[anchor=west]{yes}(good);
\draw[arrow](trap) node[anchor=south, xshift=4.5cm]{no} --
(error);
\draw[arrow](error) -- (bad);

\end{tikzpicture}

\subsubsection{Determine if the input is eligible for integers in a specific
range}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(in)[process, below of=begin, yshift=0.5cm]{Get user input};
\node(trap)[decision, below of=in, aspect=2.5]{The input is an integer?};
\node(maxMin)[decision, below of=in, aspect=3, below of=trap, yshift=1cm]{The input is between the minimum \& the
maxium?};
\node(errorType)[io, right of=trap, xshift=5cm]{Output Type error};
\node(errorRange)[io, right of=maxMin, xshift=5cm]{Output Range error};
\node(good)[startstop, below of=maxMin, yshift=-1cm]{Eligible};
\node(bad)[startstop, right of=good, xshift=5cm]{Ineligible};

\draw[arrow](begin) -- (in);
\draw[arrow](in) -- (trap);
\draw[arrow](trap) -- (maxMin);
\draw[arrow](trap) -- node[anchor=west]{yes}(maxMin);
\draw[arrow](maxMin) -- node[anchor=west]{yes}(good);
\draw[arrow](trap) node[anchor=south, xshift=4.5cm]{no} -- (errorType);
\draw[arrow](errorType) -- ([xshift=1cm]errorType.east) --
([xshift=1cm]errorRange.east) |- (bad);
\draw[arrow](errorRange) -- (bad);
\draw[arrow](maxMin) node[anchor=south, xshift=5.2cm]{no} -- (errorRange);

\end{tikzpicture}

\subsection{Process Input \& Update Properties}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(input)[process, below of=begin]{Get user input};
\node(command)[decision, below of=input, aspect=2.5]{The input is a general
command?};
\node(comm)[process, right of=command, xshift=5cm, aspect=2.5]{Execute the
command};
\node(misAns)[decision, below of=command, aspect=2.5, yshift=-1.5cm]{The input
is answering a mission problem?};
\node(misError)[process, right of=misAns, xshift=5cm, text width=3cm]{Display
Incomprehensible error};
\node(ans)[decision, below of=misAns, aspect=2.5, yshift=-1.5cm]{The input
answers correctly?};
\node(next)[process, right of=ans, xshift=5cm]{Next question};
\node(again)[process, below of=ans, yshift=-0.5cm]{Answer again};
\node(end)[startstop, right of=again, xshift=5cm]{End};

\draw[arrow](begin) -- (input);
\draw[arrow](input) -- (command);
\draw[arrow](command) -- node[anchor=south]{ys}(comm);
\draw[arrow](command) -- node[anchor=west]{no}(misAns);
\draw[arrow](misAns) -- node[anchor=south]{no}(misError);
\draw[arrow](misAns) -- node[anchor=west]{yes}(ans);
\draw[arrow](ans) -- node[anchor=south]{yes}(next);
\draw[arrow](ans) -- node[anchor=west]{no}(again);
\draw[arrow](next) -- (end);
\draw[arrow](again) -- (end);
\draw[arrow](misError) -- ([xshift=1cm]misError.east);
\draw[arrow](comm) -- ([xshift=1cm]comm.east) |- (end);

\end{tikzpicture}
\subsubsection{Commands}
The following commands are planned as a general commands for the whole game
instead of a particular mission, those in bracket are shortcut:
\emph{save} (\emph{s}), \emph{quit} (\emph{q}),\emph{help} (\emph{h}),
\emph{load}, \emph{myinfo}, and \emph{feedback}.
\paragraph{Save}

\subsection{Game-ending Decision}
\begin{tikzpicture}[node distance=2.5cm]

\node(begin)[startstop]{Begin};
\node(alive)[decision, right of=begin, xshift=4cm, aspect=2.5]{The player is
alive?};
\node(rank)[decision, below of=alive, aspect=2.5, yshift=-1cm]{The player is now
a superintendent?};
\node(good)[startstop, below of=begin, yshift=-1cm]{Game OK};
\node(bad)[startstop, right of=rank, xshift=4cm]{Game over};

\draw[arrow](begin) -- (alive);
\draw[arrow](alive) node[anchor=south, xshift=5cm]{no} -| (bad);
\draw[arrow](alive) -- node[anchor=west]{yes}(rank);
\draw[arrow](rank) -- node[anchor=south]{no}(good);
\draw[arrow](rank) -- node[anchor=south]{yes}(bad);

\end{tikzpicture}

\clearpage
% UI example
\section{User Interface}
\begin{figure}[h]
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=\linewidth]{./img/ui1}
\caption{start page}
\end{subfigure}
~
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=\linewidth]{./img/ui2}
\caption{help document}
\end{subfigure}

\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=\linewidth]{./img/ui3}
\caption{game beginning}
\end{subfigure}
~
\begin{subfigure}[b]{0.4\textwidth}
\includegraphics[width=\linewidth]{./img/ui4}
\caption{mission generation}
\end{subfigure}
\caption{UI examples}
\end{figure}

% source
\part{Program Source}
% list settings
\lstset{language=Java, numbers=left, breaklines=true, showstringspaces=false,
basicstyle=\footnotesize\ttfamily, tabsize=2}
% source
\chapter{Source}
The source code of the program can be also found at
\url{https://github.com/zhantongz/person-of-interest} with other program
resources, and \LaTeX\ sources and generated PDFs of the program documents.
The project binder is also accompanied with a DVD which includes all the
resources above.

The Java source code and program resources are placed in different directory.
\texttt{src} is for program source that define how the program work. And
\texttt{res} is for resources that provide meaningful resources to be processed
by the program.

\section{Agent.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Agent.java}

\section{Game.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Game.java}

\section{Location.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Location.java}

\section{Mission.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Mission.java}

\section{Person.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Person.java}

\section{Player.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Player.java}

\section{POI.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/POI.java}

\section{Problem.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Problem.java}

\section{Saved.java}
\lstinputlisting{../personOfInterest/src/personOfInterest/Saved.java}

Program resources are not included because of their large sizes and the inability to show source (like binary files). Those resources can be obtained from the DVD attached and the git repository at \url{https://github.com/zhantongz/person-of-interest}.

% evaluation
\part{Evaluation}
% general evaluation
Over all, this project contains 1056 lines of Java codes.
% program structure and document
\chapter{Program Structure}
\input{./tex/prg.tex}
\end{document}